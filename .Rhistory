rename(accessRating = "Please rate the ease of use for accessing the Video Consultation today?") %>%
rename(overallRating = "Please rate your overall experience of the Video Consultation today?") %>%
rename(reUse = "Would you be happy to use the Video Consultation again?") %>%
rename(comments = "Please provide us with any additional comments/ suggestions.") %>%
rename(department = "Waiting Area") %>%
mutate(Site = 'Other') %>%
mutate(Site = if_else(str_detect(department, 'RLH') == TRUE, 'RLH', Site)) %>%
mutate(Site = if_else(str_detect(department,'AUH') == TRUE, 'AUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'LUH') == TRUE, 'LUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'BGH') == TRUE, 'BGH', Site)) %>%
mutate(accessRating = str_replace(accessRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = str_replace(overallRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = if_else(overallRating == 'Very Satisfied', 'Satisfied', overallRating)) %>%
mutate(overallRating = if_else(overallRating == 'Very Dissatisfied', 'Dissatisfied', overallRating)) %>%
mutate(overallRating = factor(overallRating, levels = c('Dissatisfied', 'Neutral', 'Satisfied'))) %>%
mutate(ageGroup = factor(ageGroup, c('16 - 25', '26 - 35', '36 - 45', '46 - 65', '65+'))) %>%
mutate(department = str_remove(department, '^\\w*-')) %>%
mutate(month = month(start, label = TRUE)) %>%
mutate(year = year(start)) %>%
group_by(year) %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ")
read_csv('rawData/raw_data.csv') %>%
rename(patId = "Respondent ID") %>%
rename(colId = "Collector ID") %>%
rename(start = "Start Date") %>%
rename(end = "End Date") %>%
rename(ageGroup = "What age group do you belong?") %>%
rename(accessRating = "Please rate the ease of use for accessing the Video Consultation today?") %>%
rename(overallRating = "Please rate your overall experience of the Video Consultation today?") %>%
rename(reUse = "Would you be happy to use the Video Consultation again?") %>%
rename(comments = "Please provide us with any additional comments/ suggestions.") %>%
rename(department = "Waiting Area") %>%
mutate(Site = 'Other') %>%
mutate(Site = if_else(str_detect(department, 'RLH') == TRUE, 'RLH', Site)) %>%
mutate(Site = if_else(str_detect(department,'AUH') == TRUE, 'AUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'LUH') == TRUE, 'LUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'BGH') == TRUE, 'BGH', Site)) %>%
mutate(accessRating = str_replace(accessRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = str_replace(overallRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = if_else(overallRating == 'Very Satisfied', 'Satisfied', overallRating)) %>%
mutate(overallRating = if_else(overallRating == 'Very Dissatisfied', 'Dissatisfied', overallRating)) %>%
mutate(overallRating = factor(overallRating, levels = c('Dissatisfied', 'Neutral', 'Satisfied'))) %>%
mutate(ageGroup = factor(ageGroup, c('16 - 25', '26 - 35', '36 - 45', '46 - 65', '65+'))) %>%
mutate(department = str_remove(department, '^\\w*-')) %>%
mutate(month = month(start, label = TRUE)) %>%
mutate(year = year(start)) %>%
group_by(year) %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1])
read_csv('rawData/raw_data.csv') %>%
rename(patId = "Respondent ID") %>%
rename(colId = "Collector ID") %>%
rename(start = "Start Date") %>%
rename(end = "End Date") %>%
rename(ageGroup = "What age group do you belong?") %>%
rename(accessRating = "Please rate the ease of use for accessing the Video Consultation today?") %>%
rename(overallRating = "Please rate your overall experience of the Video Consultation today?") %>%
rename(reUse = "Would you be happy to use the Video Consultation again?") %>%
rename(comments = "Please provide us with any additional comments/ suggestions.") %>%
rename(department = "Waiting Area") %>%
mutate(Site = 'Other') %>%
mutate(Site = if_else(str_detect(department, 'RLH') == TRUE, 'RLH', Site)) %>%
mutate(Site = if_else(str_detect(department,'AUH') == TRUE, 'AUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'LUH') == TRUE, 'LUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'BGH') == TRUE, 'BGH', Site)) %>%
mutate(accessRating = str_replace(accessRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = str_replace(overallRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = if_else(overallRating == 'Very Satisfied', 'Satisfied', overallRating)) %>%
mutate(overallRating = if_else(overallRating == 'Very Dissatisfied', 'Dissatisfied', overallRating)) %>%
mutate(overallRating = factor(overallRating, levels = c('Dissatisfied', 'Neutral', 'Satisfied'))) %>%
mutate(ageGroup = factor(ageGroup, c('16 - 25', '26 - 35', '36 - 45', '46 - 65', '65+'))) %>%
mutate(department = str_remove(department, '^\\w*-')) %>%
mutate(month = month(start, label = TRUE)) %>%
mutate(year = year(start)) %>%
group_by(year) %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1))
read_csv('rawData/raw_data.csv') %>%
rename(patId = "Respondent ID") %>%
rename(colId = "Collector ID") %>%
rename(start = "Start Date") %>%
rename(end = "End Date") %>%
rename(ageGroup = "What age group do you belong?") %>%
rename(accessRating = "Please rate the ease of use for accessing the Video Consultation today?") %>%
rename(overallRating = "Please rate your overall experience of the Video Consultation today?") %>%
rename(reUse = "Would you be happy to use the Video Consultation again?") %>%
rename(comments = "Please provide us with any additional comments/ suggestions.") %>%
rename(department = "Waiting Area") %>%
mutate(Site = 'Other') %>%
mutate(Site = if_else(str_detect(department, 'RLH') == TRUE, 'RLH', Site)) %>%
mutate(Site = if_else(str_detect(department,'AUH') == TRUE, 'AUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'LUH') == TRUE, 'LUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'BGH') == TRUE, 'BGH', Site)) %>%
mutate(accessRating = str_replace(accessRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = str_replace(overallRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = if_else(overallRating == 'Very Satisfied', 'Satisfied', overallRating)) %>%
mutate(overallRating = if_else(overallRating == 'Very Dissatisfied', 'Dissatisfied', overallRating)) %>%
mutate(overallRating = factor(overallRating, levels = c('Dissatisfied', 'Neutral', 'Satisfied'))) %>%
mutate(ageGroup = factor(ageGroup, c('16 - 25', '26 - 35', '36 - 45', '46 - 65', '65+'))) %>%
mutate(department = str_remove(department, '^\\w*-')) %>%
mutate(month = month(start, label = TRUE)) %>%
mutate(year = year(start)) %>%
group_by(year) %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1)) %>%
group_by(patId)
ggplot(Bigram)
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
df
triwords = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% stopwords_filter$word) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 3) %>%
mutate(triword = trigram) %>%
separate(trigram, c('word1', 'word2', 'word3'), ' ')
df %>%
filter(!is.na(comments))
df %>%
filter(!is.na(comments)) %>%
select(patId, (comments))
df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1)
df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ")
df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1])
df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1))
df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1)) %>%
group_by(patId)
df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1))
df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1)) %>%
# group_by(patId) %>%
summarise(words = str_c(word1, collapse = " "))
df = read_csv('rawData/raw_data.csv') %>%
rename(patId = "Respondent ID") %>%
rename(colId = "Collector ID") %>%
rename(start = "Start Date") %>%
rename(end = "End Date") %>%
rename(ageGroup = "What age group do you belong?") %>%
rename(accessRating = "Please rate the ease of use for accessing the Video Consultation today?") %>%
rename(overallRating = "Please rate your overall experience of the Video Consultation today?") %>%
rename(reUse = "Would you be happy to use the Video Consultation again?") %>%
rename(comments = "Please provide us with any additional comments/ suggestions.") %>%
rename(department = "Waiting Area") %>%
mutate(Site = 'Other') %>%
mutate(Site = if_else(str_detect(department, 'RLH') == TRUE, 'RLH', Site)) %>%
mutate(Site = if_else(str_detect(department,'AUH') == TRUE, 'AUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'LUH') == TRUE, 'LUH', Site)) %>%
mutate(Site = if_else(str_detect(department,'BGH') == TRUE, 'BGH', Site)) %>%
mutate(accessRating = str_replace(accessRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = str_replace(overallRating, 'Neither Satisfied nor Dissatisfied', 'Neutral')) %>%
mutate(overallRating = if_else(overallRating == 'Very Satisfied', 'Satisfied', overallRating)) %>%
mutate(overallRating = if_else(overallRating == 'Very Dissatisfied', 'Dissatisfied', overallRating)) %>%
mutate(overallRating = factor(overallRating, levels = c('Dissatisfied', 'Neutral', 'Satisfied'))) %>%
mutate(ageGroup = factor(ageGroup, c('16 - 25', '26 - 35', '36 - 45', '46 - 65', '65+'))) %>%
mutate(department = str_remove(department, '^\\w*-')) %>%
select(patId:accessRating, overallRating, everything())
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
Bigram
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
Bigram %>%
count(biwords, sort = TRUE) %>%
filter(!is.na(biwords)) %>%
slice(1:30) %>%
ggplot(aes(x = reorder(biwords, n), y = n)) +
geom_bar(stat = 'identity') +
coord_flip() +
xlab(NULL) +
ylab('Count')
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 !%in% filter(stop_words, lexicon == 'SMART')[1]) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
# plot top 20 biwords
Bigram %>%
count(biwords, sort = TRUE) %>%
filter(!is.na(biwords)) %>%
slice(1:30) %>%
ggplot(aes(x = reorder(biwords, n), y = n)) +
geom_bar(stat = 'identity') +
coord_flip() +
xlab(NULL) +
ylab('Count')
filter(stop_words, lexicon == 'SMART')[1]
filter(stop_words, lexicon == 'SMART')[1]
stopwords_filter$words
stopwords_filter$word
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% as.list(filter(stop_words, lexicon == 'SMART')[1])) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
# plot top 20 biwords
Bigram %>%
count(biwords, sort = TRUE) %>%
filter(!is.na(biwords)) %>%
slice(1:30) %>%
ggplot(aes(x = reorder(biwords, n), y = n)) +
geom_bar(stat = 'identity') +
coord_flip() +
xlab(NULL) +
ylab('Count')
as.list(filter(stop_words, lexicon == 'SMART')[1])
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% stopwords_filter$word) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
Bigram %>%
count(biwords, sort = TRUE) %>%
filter(!is.na(biwords)) %>%
slice(1:30) %>%
ggplot(aes(x = reorder(biwords, n), y = n)) +
geom_bar(stat = 'identity') +
coord_flip() +
xlab(NULL) +
ylab('Count')
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% as.list(filter(stop_words, lexicon == 'SMART')[1])) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
# plot top 20 biwords
Bigram %>%
count(biwords, sort = TRUE) %>%
filter(!is.na(biwords)) %>%
slice(1:30) %>%
ggplot(aes(x = reorder(biwords, n), y = n)) +
geom_bar(stat = 'identity') +
coord_flip() +
xlab(NULL) +
ylab('Count')
View(Bigram)
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% stopwords_filter$word) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
Bigram %>%
count(biwords, sort = TRUE) %>%
filter(!is.na(biwords)) %>%
slice(1:30) %>%
ggplot(aes(x = reorder(biwords, n), y = n)) +
geom_bar(stat = 'identity') +
coord_flip() +
xlab(NULL) +
ylab('Count')
View(df)
library(textclean)
df %>% mutate(comments = replace_non_ascii(comments))
df %>% mutate(comments = replace_non_ascii(comments), '')
replace_non_ascii(df$comments), '')
replace_non_ascii(df$comments, '')
replace_non_ascii(df$comments)
triwords = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% stopwords_filter$word) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 3) %>%
mutate(triword = trigram) %>%
separate(trigram, c('word1', 'word2', 'word3'), ' ')
# plot top 20
triwords %>%
count(triword, sort = TRUE) %>%
filter(!is.na(triword)) %>%
slice(1:20) %>%
ggplot(aes(x = reorder(triword, n), y= n)) +
geom_bar(stat = 'identity') +
coord_flip() +
xlab(NULL) +
ylab('Count')
Bigram = df %>%
filter(!is.na(comments)) %>%
select(patId, (comments)) %>%
unnest_tokens(trigram, comments, token = "ngrams", n = 1) %>%
separate(trigram, c("word1"), sep = " ") %>%
filter(!word1 %in% stopwords_filter$word) %>%
filter(!is.na(word1)) %>%
group_by(patId) %>%
summarise(words = str_c(word1, collapse = " ")) %>%
ungroup() %>%
unnest_tokens(trigram, words, token = "ngrams", n = 2) %>%
mutate(biwords = trigram) %>%
separate(trigram, c('word1', 'word2'), ' ')
Bigram %>%
count(biwords, sort = TRUE) %>%
filter(!is.na(biwords)) %>%
slice(1:30) %>%
ggplot(aes(x = reorder(biwords, n), y = n)) +
geom_bar(stat = 'identity') +
coord_flip() +
xlab(NULL) +
ylab('Count')
annotate_figure(ggarrange(f_RLH,f_AUH,f_BGH,
nrow = 3,
widths = c(1, 1, 0.2), heights = c(3, 3, 1.6),
common.legend = TRUE,
legend = "bottom"),
left = text_grob("Percent", rot = 90))
x = as.data.frame(table(df$department)) %>%
filter(Freq > 100)
f_RLH = df %>%
filter(Site == 'RLH') %>%
filter(department %in% x$Var1) %>%
ggplot(aes(x= overallRating,  group=department)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop.., accuracy = 0.1),
y= ..prop.. ), stat= "count", vjust = 0, size = 2) +
labs(y = "Percent", fill = 'overallRating') +
facet_wrap(~ department, ncol = 6) +
scale_y_continuous(labels = scales::percent) +
# coord_cartesian(ylim = c(0, 0.)) +
scale_fill_discrete(name = "Overall Rating",
labels = c("Very Dissatisified", "Dissatisfied", "Neutral",
"Satisified", "Very Satisfied")) +
theme(text = element_text(size=8),
axis.text.x=element_blank(), axis.ticks.x=element_blank(),
strip.text = element_text(size = 5), plot.title = element_text(size = 8, face = 'bold')) +
ggtitle('Royal Liverpool Hospital', ) +
xlab(NULL) +
ylab(NULL)
f_AUH = df %>%
filter(Site == 'AUH') %>%
filter(department %in% x$Var1) %>%
ggplot(aes(x= overallRating,  group=department)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop.., accuracy = 0.1),
y= ..prop.. ), stat= "count", vjust = 0, size = 2) +
labs(y = "Percent", fill = 'overallRating') +
facet_wrap(~ department, ncol = 6) +
scale_y_continuous(labels = scales::percent) +
# coord_cartesian(ylim = c(0, 0.)) +
scale_fill_discrete(name = "Overall Rating",
labels = c("Very Dissatisified", "Dissatisfied", "Neutral",
"Satisified", "Very Satisfied")) +
theme(text = element_text(size=8),
axis.text.x=element_blank(), axis.ticks.x=element_blank(),
strip.text = element_text(size = 5), plot.title = element_text(size = 8, face = 'bold')) +
ggtitle('Aintree Hospital') +
xlab(NULL) +
ylab(NULL)
f_BGH = df %>%
filter(Site == 'BGH') %>%
filter(department %in% x$Var1) %>%
ggplot(aes(x= overallRating,  group=department)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
geom_text(aes( label = scales::percent(..prop.., accuracy = 0.1),
y= ..prop.. ), stat= "count", vjust = 0, size = 2) +
labs(y = "Percent", fill = 'overallRating') +
facet_wrap(~ department, ncol = 6) +
scale_y_continuous(labels = scales::percent) +
# coord_cartesian(ylim = c(0, 0.)) +
scale_fill_discrete(name = "Overall Rating",
labels = c("Very Dissatisified", "Dissatisfied", "Neutral",
"Satisified", "Very Satisfied")) +
theme(text = element_text(size=8),
axis.text.x=element_blank(), axis.ticks.x=element_blank(),
strip.text = element_text(size = 5), plot.title = element_text(size = 8, face = 'bold')) +
ggtitle('Broadgreen Hospital') +
xlab(NULL) +
ylab(NULL)
annotate_figure(ggarrange(f_RLH,f_AUH,f_BGH,
nrow = 3,
widths = c(1, 1, 0.2), heights = c(3, 3, 1.6),
common.legend = TRUE,
legend = "bottom"),
left = text_grob("Percent", rot = 90))
annotate_figure(ggarrange(f_RLH,f_AUH,NULL,f_BGH,
nrow = 3,
widths = c(1, 1, 0.2), heights = c(3, 3, 1.6),
common.legend = TRUE,
legend = "bottom"),
left = text_grob("Percent", rot = 90))
names(df)
colnames(df)
